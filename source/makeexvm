# Project: exvm
# Makefile created by Patrik Axelsson :=)

# Explanations for the stuff used on the following lines:
# $@ -	Full name of the target - the object-file on the left of the ':'
# $< -	The first dependency of the object-file which is the
#	corresponding C++-file if you generate these dependendy-lines
#	with "g++ -MM *.cpp".
#
# The variables CXX and RM and many more are already predefined in the
# make program.

BIN  = exvm
CXXFLAGS = -O3 -Wall
OBJ  = main.o machine.o op_control.o op_load.o op_store.o op_move.o op_jump.o  \
  op_convert.o op_arithmetic.o op_logic.o vmcore.o op_normal_table.o

$(BIN): $(OBJ) Makefile
	$(CXX) $(CXXFLAGS) $(OBJ) -o $(BIN)

main.o: main.cpp vmcore.hpp vm.hpp machine.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

virtual.o: virtual.cpp vmcore.hpp vm.hpp machine.hpp vm_handlers.hpp vminline.hpp vm_codemacros.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

machine.o: machine.cpp machine.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<
	
op_control.o: op_control.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_load.o: op_load.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_store.o: op_store.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_move.o: op_move.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_jump.o: op_jump.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_convert.o:op_convert.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_arithmetic.o: op_arithmetic.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_logic.o: op_logic.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

vmcore.o: vmcore.cpp vmcore.hpp vm.hpp machine.hpp vminline.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<

op_normal_table.o: op_normal_table.cpp vmcore.hpp vm.hpp machine.hpp
	$(CXX) $(CXXFLAGS) -o $@ -c $<


clean:
	$(RM) $(TARGET) *.o *~ core

